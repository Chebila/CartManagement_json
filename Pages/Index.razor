@page "/"
@inject NavigationManager NavigationManager
@inject ECommerceApp.Services.ProductService ProductService
@inject ECommerceApp.Services.CartService CartService


<h1>Welcome to the Store</h1>

<p>Welcome — browse our catalog or view your cart.</p>

<div style="margin-top:1rem;">
    <button class="btn btn-primary" @onclick="GoToProducts">Browse Products (@productCount)</button>
    <button class="btn btn-secondary" @onclick="GoToCart" style="margin-left:0.5rem;">View Cart (@cartCount)</button>
</div>

<hr />

@code {
    private int productCount = 0;
    private int cartCount = 0;

    protected override void OnInitialized()
    {
        var products = ProductService.GetAll();
        productCount = products?.Count ?? 0;

        //Count items in cookie-backed cart
        var itemsWithProducts = CartService.GetCartItemsWithProducts();
        cartCount = itemsWithProducts?.Count ?? 0;
    }

    private void GoToProducts() => NavigationManager.NavigateTo("/products");
    private void GoToCart() => NavigationManager.NavigateTo("/cart");
}